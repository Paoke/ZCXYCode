<!--_meta 作为公共模版分离出去-->
<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="renderer" content="webkit|ie-comp|ie-stand">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
        <meta http-equiv="Cache-Control" content="no-siteapp"/>
        <LINK rel="Bookmark" href="/favicon.ico">
        <LINK rel="Shortcut Icon" href="/favicon.ico"/>
        <!--[if lt IE 9]>
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_JS_URL}html5.js"></script>
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_JS_URL}respond.min.js"></script>
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_JS_URL}PIE_IE678.js"></script>
        <![endif]-->
        <link rel="stylesheet" type="text/css" href="{$smarty.const.ADMIN_STATIC_HUI_CSS_URL}H-ui.min.css"/>
        <link rel="stylesheet" type="text/css" href="{$smarty.const.ADMIN_STATIC_HUI_CSS_URL}H-ui.admin.css"/>
        <link rel="stylesheet" type="text/css" href="{$smarty.const.ADMIN_LIB_HUI_ICONFONT_CSS_URL}iconfont.css"/>
        <link rel="stylesheet" type="text/css" href="{$smarty.const.ADMIN_LIB_ICHECK_CSS_URL}icheck.css"/>
        <link rel="stylesheet" type="text/css" href="{$smarty.const.ADMIN_STATIC_HUI_SKIN_DEFAULT_CSS_URL}skin.css" id="skin"/>
        <link rel="stylesheet" type="text/css" href="{$smarty.const.ADMIN_STATIC_HUI_CSS_URL}style.css"/>
        <!--[if IE 6]>
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_JS_URL}DD_belatedPNG_0.0.8a-min.js"></script>
        <script>DD_belatedPNG.fix('*');</script>
        <![endif]-->
        <link href="{$smarty.const.ADMIN_LIB_WEBUPLOADER_CSS_URL}webuploader.css" rel="stylesheet" type="text/css" />

        <!--/meta 作为公共模版分离出去-->

        <title>云珠沙龙TIC</title>
    </head>
    <body>
        <article class="page-container">
            <form class="form form-horizontal" id="form-article-add">
                <input type="hidden" id="img1" name="img1">
                <input type="hidden" id="content" name="content">
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2"><span class="c-red">* </span>文章标题：</label>
                    <div class="formControls col-xs-8 col-sm-9">
                        <input type="text" class="input-text" value="" placeholder="" id="title" name="title">
                    </div>
                </div>

                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2"><span class="c-red">* </span>主讲嘉宾：</label>
                    <div class="formControls col-xs-8 col-sm-9">
                        <span class="select-box">
                            <select class="select" size="1" id="guid" name="guid">
                                <option value="0" selected>请选择</option>
                                {foreach $arrData as $k1=>$v1}
                                <option value="{$v1.guid}">{$v1.name}</option>
                                {/foreach}
                            </select>
                        </span>
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2"><span class="c-red">* </span>文章来源：</label>
                    <div class="formControls col-xs-8 col-sm-9">
                        <input type="text" class="input-text" value="" placeholder="" id="source" name="source">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2"><span class="c-red">* </span>视频链接：</label>
                    <div class="formControls col-xs-8 col-sm-9">
                        <input type="text" class="input-text" value="" placeholder="" id="link" name="link">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2"><span class="c-red">* </span>浏览次数：</label>
                    <div class="formControls col-xs-8 col-sm-9">
                        <input type="text" class="input-text" value="" placeholder="" id="seetimes" name="seetimes">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2"><span class="c-red">* </span>文章首图：</label>
                    <div class="formControls col-xs-8 col-sm-9">
                        <input type="file" class="banner1" name="banner1"><span class="c-red" id="success">(图片规格：1100*670)</span>
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2"><span class="c-red">* </span>文章内容：</label>
                    <div class="formControls col-xs-8 col-sm-9">
                        <script id="editor" type="text/plain" style="width:1100px;height:800px;"></script>
                    </div>
                </div>
                <div class="row cl">
                    <div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-2">
                        <button class="btn btn-primary radius" id="btn_submit" type="button" ><i class="Hui-iconfont">
                                &#xe632;</i> 保存
                        </button>

                    </div>
                </div>
            </form>
        </article>

        <!--_footer 作为公共模版分离出去-->
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_JQUERY_JS_URL}jquery.min.js"></script>
        <script type="text/javascript" src="{$smarty.const.ADMIN_JS_URL}jquery.form.js"></script>
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_LAYER_JS_URL}layer.js"></script>
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_ICHECK_JS_URL}jquery.icheck.min.js"></script>
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_JQUERYVALIDATION_JS_URL}jquery.validate.min.js"></script>
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_JQUERYVALIDATION_JS_URL}validate-methods.js"></script>
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_JQUERYVALIDATION_JS_URL}messages_zh.min.js"></script>
        <script type="text/javascript" src="{$smarty.const.ADMIN_STATIC_HUI_JS_URL}H-ui.js"></script>
        <script type="text/javascript" src="{$smarty.const.ADMIN_STATIC_HUI_JS_URL}H-ui.admin.js"></script>
        <!--/_footer /作为公共模版分离出去-->

        <!--请在下方写此页面业务相关的脚本-->
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_MY97DATEPICKER_JS_URL}WdatePicker.js"></script>
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_WEBUPLOADER_JS_URL}webuploader.min.js"></script>
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_UEDITOR_JS_URL}ueditor.config.js"></script>
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_UEDITOR_JS_URL}ueditor.all.min.js"></script>
        <script type="text/javascript" src="{$smarty.const.ADMIN_LIB_UEDITOR_JS_URL}lang/zh-cn/zh-cn.js"></script>
        {literal}
        <script type="text/javascript">
            //实例化编辑器
            //建议使用工厂方法getEditor创建和引用编辑器实例，如果在某个闭包下引用该编辑器，直接调用UE.getEditor('editor')就能拿到相关的实例
            var ue = UE.getEditor('editor');
            function getLocalData() {
                //document.getElementById("content").value = UE.getEditor('editor').execCommand("getlocaldata");
                document.getElementById("content").value = UE.getEditor('editor').getContent();
            }
            $('#btn_submit').on('click', function () {
                getLocalData();
                var title=$('#title').val();
                var guid=$('#guid').val();
                var source=$('#source').val();
                var link=$('#link').val();
                var seetimes=$('#seetimes').val();
                var banner=$('#img1').val();
                var content=$('#content').val();
                
                if(title==""||guid==""||source==""||link==""||seetimes==""||banner==""||content==""){
                    layer.msg('请把资料填完整', {icon: 7, time: 2000});
                    return false;
                }
                var data={title:title,guid:guid,source:source,link:link,seetimes:seetimes,banner:banner,content:content};
                $.post('/index.php/Admin/Article/addArticle', data, function (ret) {
                    if (ret == 'true') {
                        layer.msg('上传成功!', {icon: 1, time: 1000},function(){
                            var index = parent.layer.getFrameIndex(window.name);

                            parent.layer.close(index);
                        });

                    } else {
                            layer.msg('上传失败!', {icon: 2, time: 1000});
                    }
                },'json');
            });
            $('.banner1').on('change', function () {
                if ($("#banner1").length > 0) {

                } else {
                    $(".banner1").wrap("<form id='banner1' action='/index.php/Admin/Article/uploadPic?type=banner1' method='post' enctype='multipart/form-data'></form>");
                }
                /*ajax提交*/
                $("#banner1").ajaxSubmit({
                    dataType: 'json',
                    beforeSend: function () {

                    },
                    uploadProgress: function (event, position, total, percentComplete) {

                    },
                    success: function (data) {
                        if (data.result == 'true') {
                            $('#img1').val(data.img);
                            $('#success').html('(上传成功)');
                            layer.msg('上传成功!', {icon: 1, time: 1000});
                            return false;
                        } else {
                            $('.banner1').val("");
                            layer.msg('上传失败!', {icon: 2, time: 1000});
                            return false;
                        }
                    },
                    error: function (xhr) {
                        //var result = $.trim(xhr.responseText);//去掉字符串两端的空白
                    }
                });
            });
        </script>
        {/literal}
        <!--/请在上方写此页面业务相关的脚本-->
    </body>
</html>
